<div x-data="{
    transactionLog : [],
    toBeReimbursed : [],
    grid : null,
    grid2 : null,
    init(){
        fetch('/transactions')
            .then(data => data.json())
            .then(js => Alpine.raw(js.transactions))
            .then(transactions => 
                {   
                    this.grid = agGrid.createGrid(this.$refs.myGrid, {
                    rowData : transactions,
                    columnDefs : [
                        { field: 'description', checkboxSelection: true},
                        { field: 'amount' },
                        { field: 'recipient' },
                        { field: 'createdBy' },
                        { field: 'date'}
                    ],
                    rowSelection: 'multiple',
                    onRowSelected: (event) => {
                        if(event.node.isSelected()) {
                            console.log(event.node.data, ' :Selected and added to ', this.toBeReimbursed);
                            this.toBeReimbursed.push(event.node.data);
                            this.grid2.setRowData(this.toBeReimbursed)
                            this.grid2.refreshCells()
                        } else {
                            console.log(event.node.data, ' :Deselected and removed.');
                            const index = this.toBeReimbursed.indexOf(event.node.data);

                            if (index > -1) {
                                this.toBeReimbursed.splice(index, 1);
                            }
                            console.log('Reimbused list now: ', this.toBeReimbursed);
                        }
                    }
                })
                // console.log(this.toBeReimbursed)
                console.log(transactions)
                this.grid2 = agGrid.createGrid(this.$refs.myGrid2, {
                    rowData : this.toBeReimbursed,
                    columnDefs : [
                        { field: 'description'},
                        { field: 'amount' },
                        { field: 'recipient' },
                        { field: 'createdBy' },
                        { field: 'date'}
                    ],
                })
            }
            )
        
    }
}">
    <div x-show="toBeReimbursed.length > 0">
        <div x-ref="myGrid2" class="ag-theme-quartz" style="height: 500px"></div>
    </div>
    <div x-ref="myGrid" class="ag-theme-quartz" style="height: 500px"></div>
</div>